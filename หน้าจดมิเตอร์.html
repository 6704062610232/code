<!-- เพิ่มฟอนต์ Sarabun และ FontAwesome -->
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
:root{
 --c1:#CCD5AE; --c2:#E9EDC9; --c3:#FEFAE0; --c4:#FAEDCD; --c5:#D4A373;
 --text: #555;
}

/* ปรับฟอนต์ให้เหมือนระบบอื่นๆ */
body{ font-family: 'Sarabun', sans-serif; background: var(--c3); padding: 20px; color: var(--text); margin: 0; }

.container { max-width: 1100px; margin: auto; }

/* --- Header: สไตล์เดียวกับระบบพัสดุ --- */
.header-brand { text-align: center; margin-bottom: 30px; }
.header-brand h1 { color: var(--c5); margin: 0; font-size: 32px; font-weight: 600; }

.card{ background:white; border-radius:20px; padding:25px; box-shadow:0 10px 25px rgba(0,0,0,.05); }

/* Filter Bar */
.filter-bar{ margin-bottom:20px; display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
.filter-btn{ padding:8px 18px; border-radius:20px; border:1px solid var(--c5); background:white; cursor:pointer; font-size:13px; font-weight: bold; color: var(--c5); transition: 0.3s; }
.filter-btn.active{ background:var(--c5); color:white; }
.filter-btn:hover { background: var(--c2); color: var(--text); }

/* Table Style */
.table-container{ overflow-x:auto; }
.table{ width:100%; border-collapse:collapse; font-size:14px; min-width:800px; border-radius: 12px; overflow: hidden; }
.table th, .table td{ padding:12px; border:1px solid #f0f0f0; text-align:center; }
.table th{ background: var(--c2); color: var(--text); font-weight: 600; }

.floor-header{ background: #fdfdfd !important; text-align:left !important; font-weight:bold; padding-left:15px !important; color: var(--c5); border-left: 5px solid var(--c5) !important; }

/* Input & Logic Colors */
.input-meter{ width:80px; padding:8px; border-radius:10px; border:1px solid var(--c1); text-align:center; font-weight:bold; outline: none; transition: 0.3s; }
.input-meter:focus{ border-color: var(--c5); background: #fff; box-shadow: 0 0 5px rgba(212, 163, 115, 0.3); }
.unit-val{ color:#4F772D; font-weight:bold; }
.btn-main { width: 100%; padding: 15px; border: none; border-radius: 15px; background: var(--c5); color: white; font-weight: bold; cursor: pointer; margin-top: 20px; font-size: 16px; transition: 0.3s; }
.btn-main:hover { background: #bc8a5f; transform: translateY(-2px); }

@media (max-width: 600px) {
    .filter-bar { justify-content: center; }
}
</style>

<!-- ส่วน HTML -->
<div class="container">
    <section id="meter">
        <!-- เปลี่ยนหัวข้อด้านบน -->
        <div class="header-brand">
            <h1><i class="fas fa-tachometer-alt"></i> จดมิเตอร์</h1>
        </div>

        <div class="card">
            <!-- ส่วนตัวกรองเลขชั้น -->
            <div class="filter-bar">
                <span style="font-weight: bold; color: var(--c5);">เลือกชั้น:</span>
                <button class="filter-btn active" onclick="filterMeterTable('all', this)">ทั้งหมด</button>
                <button class="filter-btn" onclick="filterMeterTable(1, this)">ชั้น 1</button>
                <button class="filter-btn" onclick="filterMeterTable(2, this)">ชั้น 2</button>
                <button class="filter-btn" onclick="filterMeterTable(3, this)">ชั้น 3</button>
                <button class="filter-btn" onclick="filterMeterTable(4, this)">ชั้น 4</button>
                <button class="filter-btn" onclick="filterMeterTable(5, this)">ชั้น 5</button>
            </div>

            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th rowspan="2">ห้อง</th>
                            <th colspan="3" style="background:#e3f2fd; color: #1565c0;"><i class="fas fa-tint"></i> ค่าน้ำ</th>
                            <th colspan="3" style="background:#fff3e0; color: #e65100;"><i class="fas fa-bolt"></i> ค่าไฟ</th>
                            <th rowspan="2">สถานะ</th>
                        </tr>
                        <tr style="font-size:11px; background: #fafafa;">
                            <th>เลขเก่า</th><th>เลขใหม่</th><th>หน่วย</th>
                            <th>เลขเก่า</th><th>เลขใหม่</th><th>หน่วย</th>
                        </tr>
                    </thead>
                    <tbody id="meterTableBody">
                        <!-- ข้อมูลจะถูกสร้างด้วย JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <button class="btn-main" onclick="alert('บันทึกข้อมูลมิเตอร์เรียบร้อยแล้ว')"><i class="fas fa-save"></i> บันทึกเลขมิเตอร์ทั้งหมด</button>
        </div>
    </section>
</div>

<!-- ส่วน JavaScript (คงเดิม) -->
<script>
let roomData = [];

function generateData() {
    for(let f=1; f<=5; f++) {
        for(let r=1; r<=10; r++) {
            let id = f * 100 + r;
            roomData.push({ 
                id: id, 
                floor: f, 
                pw: 120 + (id), 
                pe: 540 + (id * 2) 
            });
        }
    }
    renderMeterTable();
}

function renderMeterTable() {
    const tbody = document.getElementById('meterTableBody');
    tbody.innerHTML = '';
    let lastFloor = 0;

    roomData.forEach(r => {
        if(r.floor !== lastFloor) {
            lastFloor = r.floor;
            tbody.innerHTML += `<tr data-f="${lastFloor}"><td colspan="8" class="floor-header">ชั้น ${lastFloor}</td></tr>`;
        }

        tbody.innerHTML += `
            <tr data-f="${r.floor}">
                <td><b>${r.id}</b></td>
                <td><span id="pw-${r.id}">${r.pw}</span></td>
                <td><input type="number" class="input-meter" oninput="calcUnit('${r.id}')" id="cw-${r.id}" placeholder="..."></td>
                <td id="uw-${r.id}" class="unit-val">0</td>
                <td><span id="pe-${r.id}">${r.pe}</span></td>
                <td><input type="number" class="input-meter" oninput="calcUnit('${r.id}')" id="ce-${r.id}" placeholder="..."></td>
                <td id="ue-${r.id}" class="unit-val">0</td>
                <td id="st-${r.id}" style="color:#ccc; font-size:11px">รอจด</td>
            </tr>`;
    });
}

function calcUnit(id) {
    const pw = parseInt(document.getElementById(`pw-${id}`).innerText);
    const cw = parseInt(document.getElementById(`cw-${id}`).value) || 0;
    const pe = parseInt(document.getElementById(`pe-${id}`).innerText);
    const ce = parseInt(document.getElementById(`ce-${id}`).value) || 0;

    const waterUnit = (cw - pw) > 0 ? (cw - pw) : 0;
    const electricUnit = (ce - pe) > 0 ? (ce - pe) : 0;

    document.getElementById(`uw-${id}`).innerText = waterUnit;
    document.getElementById(`ue-${id}`).innerText = electricUnit;

    const statusCell = document.getElementById(`st-${id}`);
    if(cw > pw && ce > pe) {
        statusCell.innerHTML = '<i class="fas fa-check-circle"></i> เรียบร้อย';
        statusCell.style.color = '#4F772D';
        statusCell.style.fontWeight = 'bold';
    } else {
        statusCell.innerText = 'รอจด';
        statusCell.style.color = '#ccc';
        statusCell.style.fontWeight = 'normal';
    }
}

function filterMeterTable(f, btn) {
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    const rows = document.querySelectorAll('#meterTableBody tr');
    rows.forEach(row => {
        if(f === 'all') {
            row.style.display = '';
        } else {
            row.style.display = row.getAttribute('data-f') == f ? '' : 'none';
        }
    });
}

generateData();
</script>