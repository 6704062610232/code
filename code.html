<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Cozy Home Admin ‚Äì ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ 50 ‡∏´‡πâ‡∏≠‡∏á</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{
 --c1:#CCD5AE; --c2:#E9EDC9; --c3:#FEFAE0; --c4:#FAEDCD; --c5:#D4A373;
 --occupied:#a3b18a; --vacant:#fff; --maintenance:#e9c46a;
}
*{box-sizing:border-box}
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:var(--c3)}

/* --- Header & Nav (Same as User) --- */
header{background:var(--c1);padding:16px;text-align:center;font-size:22px;font-weight:bold}
nav{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;background:var(--c2);padding:10px;position:sticky;top:0;z-index:100}
nav button{border:none;padding:10px 14px;border-radius:20px;background:white;cursor:pointer;transition:0.2s;font-weight:bold;font-size:13px}
nav button:hover, nav button.active-btn{background:var(--c5);color:white}

/* Section Logic */
section{display:none;padding:20px;max-width:1000px;margin:0 auto}
section.active{display:block;animation:fadeIn 0.3s}
@keyframes fadeIn { from{opacity:0;transform:translateY(5px)} to{opacity:1;transform:translateY(0)} }

/* Common Components */
.card{background:white;border-radius:16px;padding:16px;margin-bottom:16px;box-shadow:0 4px 10px rgba(0,0,0,.1)}
.card h3{margin-top:0;border-bottom:2px solid var(--c2);padding-bottom:8px;margin-bottom:16px;color:var(--c5)}
.btn{margin-top:10px;padding:10px 16px;border:none;border-radius:20px;background:var(--c5);color:white;cursor:pointer;font-weight:bold}

/* Meter Table */
.table-container{overflow-x:auto}
.table{width:100%;border-collapse:collapse;font-size:14px;min-width:700px}
.table th,.table td{padding:10px;border:1px solid #eee;text-align:center}
.table th{background:#f8f9fa}
.floor-header{background:var(--c2) !important; text-align:left !important; font-weight:bold; padding-left:15px !important}
.input-meter{width:65px; padding:6px; border-radius:8px; border:1px solid var(--c5); text-align:center; font-weight:bold}
.unit-val{color:#588157; font-weight:bold}

/* Room Grid 50 Rooms */
.room-grid{display:grid;grid-template-columns:repeat(auto-fill, minmax(75px, 1fr));gap:8px;margin-top:10px}
.room-box{aspect-ratio:1/1; border:1px solid #ddd; border-radius:10px; display:flex; flex-direction:column; align-items:center; justify-content:center; font-size:12px; cursor:pointer}

/* Summary Box */
.summary-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
.summary-box{background:var(--c4);border-radius:14px;padding:16px;text-align:center;font-weight:bold}

.filter-bar{margin-bottom:15px; display:flex; gap:8px; flex-wrap:wrap}
.filter-btn{padding:6px 15px; border-radius:15px; border:1px solid var(--c5); background:white; cursor:pointer; font-size:12px}
.filter-btn.active{background:var(--c5); color:white}
</style>
</head>
<body>

<header>üè† Cozy Home ‚Äì ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ (Admin)</header>

<nav>
    <button onclick="show('meter', this)" class="active-btn">üìü ‡∏à‡∏î‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå</button>
    <button onclick="show('billing', this)">üí∏ ‡∏≠‡∏≠‡∏Å‡∏£‡∏≠‡∏ö‡∏ö‡∏¥‡∏•</button>
    <button onclick="show('rooms', this)">üè¢ ‡∏ú‡∏±‡∏á 50 ‡∏´‡πâ‡∏≠‡∏á</button>
    <button onclick="show('summary', this)">üìä ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</button>
    <button onclick="doLogout()" style="background:#ffcccc; color:#c00">üö™ ‡∏≠‡∏≠‡∏Å</button>
</nav>

<!-- 1. ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏î‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå -->
<section id="meter" class="active">
    <div class="card">
        <h3>üìü ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ô‡πâ‡∏≥-‡πÑ‡∏ü (50 ‡∏´‡πâ‡∏≠‡∏á)</h3>
        
        <!-- ‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏à‡∏î‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô -->
        <div class="filter-bar">
            <span>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏±‡πâ‡∏ô:</span>
            <button class="filter-btn active" onclick="filterMeterTable('all', this)">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            <button class="filter-btn" onclick="filterMeterTable(1, this)">‡∏ä‡∏±‡πâ‡∏ô 1</button>
            <button class="filter-btn" onclick="filterMeterTable(2, this)">‡∏ä‡∏±‡πâ‡∏ô 2</button>
            <button class="filter-btn" onclick="filterMeterTable(3, this)">‡∏ä‡∏±‡πâ‡∏ô 3</button>
            <button class="filter-btn" onclick="filterMeterTable(4, this)">‡∏ä‡∏±‡πâ‡∏ô 4</button>
            <button class="filter-btn" onclick="filterMeterTable(5, this)">‡∏ä‡∏±‡πâ‡∏ô 5</button>
        </div>

        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th rowspan="2">‡∏´‡πâ‡∏≠‡∏á</th>
                        <th colspan="3" style="background:#e3f2fd">üíß ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥</th>
                        <th colspan="3" style="background:#fff3e0">‚ö° ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü</th>
                        <th rowspan="2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                    </tr>
                    <tr style="font-size:11px">
                        <th>‡∏Å‡πà‡∏≠‡∏ô</th><th>‡πÉ‡∏´‡∏°‡πà</th><th>‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                        <th>‡∏Å‡πà‡∏≠‡∏ô</th><th>‡πÉ‡∏´‡∏°‡πà</th><th>‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                    </tr>
                </thead>
                <tbody id="meterTableBody">
                    <!-- JavaScript ‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </tbody>
            </table>
        </div>
        <button class="btn" style="width:100%; padding:15px; font-size:16px" onclick="alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 50 ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢')">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    </div>
</section>

<!-- 2. ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≠‡∏ö‡∏ö‡∏¥‡∏• -->
<section id="billing">
    <div class="card">
        <h3>üí∏ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏£‡∏≠‡∏ö‡∏ö‡∏¥‡∏•</h3>
        <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ô‡∏≥‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏à‡∏î‡πÑ‡∏õ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
        <label>‡∏£‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</label>
        <select style="width:100%; padding:10px; border-radius:10px; margin-bottom:15px">
            <option>‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° 2567</option>
            <option>‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏° 2568</option>
        </select>
        <button class="btn" style="width:100%">üöÄ ‡∏≠‡∏≠‡∏Å‡∏ö‡∏¥‡∏•‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á 50 ‡∏´‡πâ‡∏≠‡∏á</button>
    </div>
</section>

<!-- 3. ‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏±‡∏á‡∏´‡πâ‡∏≠‡∏á -->
<section id="rooms">
    <div class="card">
        <h3>üè¢ ‡∏ú‡∏±‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (50 ‡∏´‡πâ‡∏≠‡∏á)</h3>
        <div id="roomGridContainer">
            <!-- JavaScript ‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Grid ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
        </div>
    </div>
</section>

<!-- 4. ‡∏´‡∏ô‡πâ‡∏≤‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö -->
<section id="summary">
    <div class="card">
        <h3>üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h3>
        <div class="summary-grid">
            <div class="summary-box">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå<br><span style="font-size:22px; color:#588157">‡∏ø 215,000</span></div>
            <div class="summary-box">‡∏Ñ‡πâ‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞ (4 ‡∏´‡πâ‡∏≠‡∏á)<br><span style="font-size:22px; color:red">‡∏ø 18,400</span></div>
            <div class="summary-box">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πà‡∏≤<br><span style="font-size:22px">46 / 50 ‡∏´‡πâ‡∏≠‡∏á</span></div>
        </div>
    </div>
    <div class="card">
        <h4>üìà ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h4>
        <canvas id="adminChart" height="150" style="width:100%; background:#fafafa; border-radius:10px"></canvas>
    </div>
</section>

<script>
// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á 50 ‡∏´‡πâ‡∏≠‡∏á
const totalFloors = 5;
const roomsPerFloor = 10;
let roomData = [];

for(let f=1; f<=totalFloors; f++) {
    for(let r=1; r<=roomsPerFloor; r++) {
        let roomId = f * 100 + r; // 101, 102... 510
        roomData.push({
            id: roomId,
            floor: f,
            pw: Math.floor(Math.random() * 100) + 50, // ‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ô‡πâ‡∏≥‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤
            pe: Math.floor(Math.random() * 1000) + 500, // ‡πÄ‡∏•‡∏Ç‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÑ‡∏ü‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤
            status: Math.random() > 0.1 ? 'occupied' : 'vacant'
        });
    }
}

function show(id, btn){
    document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active-btn'));
    if(btn) btn.classList.add('active-btn');
    if(id === 'summary') drawAdminChart();
}

// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏î‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå
function renderMeterTable() {
    const tbody = document.getElementById('meterTableBody');
    tbody.innerHTML = '';
    let currentFloor = 0;

    roomData.forEach(room => {
        if(room.floor !== currentFloor) {
            currentFloor = room.floor;
            tbody.innerHTML += `<tr class="floor-row" data-f="${currentFloor}"><td colspan="8" class="floor-header">üè¢ ‡∏ä‡∏±‡πâ‡∏ô ${currentFloor}</td></tr>`;
        }
        
        tbody.innerHTML += `
            <tr class="room-row" data-f="${room.floor}">
                <td><b>${room.id}</b></td>
                <td><span id="pw-${room.id}">${room.pw}</span></td>
                <td><input type="number" class="input-meter" id="cw-${room.id}" oninput="calcUnit('${room.id}')"></td>
                <td><span id="uw-${room.id}" class="unit-val">0</span></td>
                <td><span id="pe-${room.id}">${room.pe}</span></td>
                <td><input type="number" class="input-meter" id="ce-${room.id}" oninput="calcUnit('${room.id}')"></td>
                <td><span id="ue-${room.id}" class="unit-val">0</span></td>
                <td id="st-${room.id}" style="color:#ccc; font-size:11px">‡∏£‡∏≠‡∏à‡∏î</td>
            </tr>
        `;
    });
}

function calcUnit(id) {
    const pw = parseInt(document.getElementById(`pw-${id}`).innerText);
    const cw = parseInt(document.getElementById(`cw-${id}`).value) || 0;
    const pe = parseInt(document.getElementById(`pe-${id}`).innerText);
    const ce = parseInt(document.getElementById(`ce-${id}`).value) || 0;

    const uw = cw - pw;
    const ue = ce - pe;

    if(cw > 0) document.getElementById(`uw-${id}`).innerText = uw >= 0 ? uw : '!!';
    if(ce > 0) document.getElementById(`ue-${id}`).innerText = ue >= 0 ? ue : '!!';
    
    if(cw > pw && ce > pe) {
        document.getElementById(`st-${id}`).innerText = '‚úÖ ‡∏à‡∏î‡πÅ‡∏•‡πâ‡∏ß';
        document.getElementById(`st-${id}`).style.color = 'green';
    }
}

function filterMeterTable(floor, btn) {
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    const rows = document.querySelectorAll('#meterTableBody tr');
    rows.forEach(row => {
        if(floor === 'all') {
            row.style.display = '';
        } else {
            row.style.display = row.getAttribute('data-f') == floor ? '' : 'none';
        }
    });
}

// ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏±‡∏á‡∏´‡πâ‡∏≠‡∏á 50 ‡∏´‡πâ‡∏≠‡∏á
function renderRoomGrid() {
    const container = document.getElementById('roomGridContainer');
    container.innerHTML = '';

    for(let f=1; f<=totalFloors; f++) {
        container.innerHTML += `<h4 style="margin:15px 0 5px 0">‡∏ä‡∏±‡πâ‡∏ô ${f}</h4>`;
        let gridHtml = '<div class="room-grid">';
        roomData.filter(r => r.floor === f).forEach(room => {
            let bgColor = room.status === 'occupied' ? 'var(--occupied)' : 'white';
            let textColor = room.status === 'occupied' ? 'white' : '#333';
            gridHtml += `
                <div class="room-box" style="background:${bgColor}; color:${textColor}">
                    <b>${room.id}</b>
                    <span style="font-size:9px">${room.status === 'occupied' ? '‡∏°‡∏µ‡∏Ñ‡∏ô‡πÄ‡∏ä‡πà‡∏≤' : '‡∏ß‡πà‡∏≤‡∏á'}</span>
                </div>
            `;
        });
        gridHtml += '</div>';
        container.innerHTML += gridHtml;
    }
}

function drawAdminChart() {
    const canvas = document.getElementById('adminChart');
    const ctx = canvas.getContext('2d');
    const data = [180000, 195000, 210000, 205000, 215000, 220000];
    const labels = ['‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'];
    
    canvas.width = canvas.offsetWidth;
    ctx.clearRect(0,0, canvas.width, canvas.height);
    const barW = canvas.width / 10;
    
    data.forEach((val, i) => {
        const x = (i + 1) * barW * 1.4;
        const barH = (val / 250000) * 120;
        ctx.fillStyle = i === 5 ? '#588157' : '#D4A373';
        ctx.fillRect(x, 150 - barH, barW, barH);
        ctx.fillStyle = '#333';
        ctx.font = '10px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(labels[i], x + barW/2, 145);
    });
}

function doLogout() {
    if(confirm('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö?')) location.reload();
}

// ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
renderMeterTable();
renderRoomGrid();
</script>

</body>
</html>