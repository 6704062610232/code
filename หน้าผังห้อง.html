<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏ú‡∏±‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢</title>
<!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏≠‡∏ô‡∏ï‡πå Sarabun ‡πÅ‡∏•‡∏∞ FontAwesome -->
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
:root{
 --c1:#CCD5AE; --c2:#E9EDC9; --c3:#FEFAE0; --c4:#FAEDCD; --c5:#D4A373;
 --occupied:#A3B18A; --vacant:#ffffff; --danger:#E5989B;
 --text: #555;
}
body{ 
    margin:0; 
    background:var(--c3); 
    font-family: 'Sarabun', sans-serif; 
    padding: 20px; 
    color: var(--text); 
}

.container { max-width: 1000px; margin: auto; }

/* --- Header: ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏±‡∏™‡∏î‡∏∏ --- */
.header-brand { text-align: center; margin-bottom: 30px; }
.header-brand h1 { color: var(--c5); margin: 0; font-size: 32px; font-weight: 600; }

/* Banner ‡∏¢‡πâ‡∏≤‡∏¢‡∏´‡πâ‡∏≠‡∏á */
#move-banner { 
    display:none; background: var(--c5); color: white; padding: 15px; 
    text-align: center; position: fixed; top: 0; left:0; width: 100%; z-index: 9999; 
    font-weight: bold; box-shadow: 0 4px 15px rgba(0,0,0,0.3); 
}
#move-banner button { margin-left:15px; padding:6px 15px; border-radius:20px; border:none; cursor:pointer; background:white; color:var(--c5); font-weight:bold; font-family: 'Sarabun', sans-serif; }

/* --- ‡∏ú‡∏±‡∏á‡∏´‡πâ‡∏≠‡∏á (Grid) --- */
.card{ background:white; border-radius:24px; padding:25px; box-shadow:0 10px 30px rgba(0,0,0,.05); }
.floor-row { display: flex; align-items: center; margin-bottom: 12px; background: rgba(255,255,255,0.6); border-radius: 35px; padding: 8px; border: 1px solid #f0f0f0; }
.floor-label { min-width: 70px; font-weight: bold; color: var(--c5); text-align: center; font-size: 13px; }
.room-container { display: flex; gap: 10px; overflow-x: auto; flex: 1; padding: 5px; }

.room-card { 
    min-width: 90px; height: 100px; border-radius: 25px; 
    display: flex; flex-direction: column; align-items: center; justify-content: center; 
    cursor: pointer; border: 2px dashed #ddd; background: var(--vacant); color: #bbb; transition: 0.2s;
}
.room-card.has-tenant { background: var(--occupied); color: white; border: none; }
.room-card b { font-size: 17px; }
.count-tag { font-size: 11px; margin-top: 4px; font-weight: bold; background: rgba(0,0,0,0.05); padding: 2px 8px; border-radius: 10px; }
.has-tenant .count-tag { background: rgba(255,255,255,0.2); color: white; }

/* ‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏∞‡∏û‡∏£‡∏¥‡∏ö‡∏ï‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢‡∏´‡πâ‡∏≠‡∏á */
.moving-mode .room-card.is-vacant-room { border: 3px solid var(--c5) !important; animation: pulseGlow 1.2s infinite; }
@keyframes pulseGlow { 0% { transform: scale(1); } 50% { transform: scale(1.05); box-shadow: 0 0 15px var(--c5); } 100% { transform: scale(1); } }

/* --- Popup Modal --- */
#modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; z-index: 5000; backdrop-filter: blur(8px); }
.modal-card { background: white; width: 95%; max-width: 500px; border-radius: 30px; padding: 25px; position: relative; animation: popUp 0.3s ease; max-height: 85vh; display: flex; flex-direction: column; box-shadow: 0 20px 40px rgba(0,0,0,0.2); }
@keyframes popUp { from{transform:scale(0.8); opacity:0} to{transform:scale(1); opacity:1} }
.close-modal { position: absolute; top: 15px; right: 20px; font-size: 28px; cursor: pointer; color: #ccc; }

.tenant-list-area { overflow-y: auto; padding-right: 5px; margin-top: 10px; }

/* Tenant Card */
.tenant-full-card { 
    background: #fcfcfc; border: 1px solid #eee; border-radius: 20px; 
    padding: 15px; margin-bottom: 15px; display: flex; flex-direction: column; gap: 12px;
}
.tenant-main-info { display: flex; align-items: center; gap: 15px; }
.profile-img-big { width: 70px; height: 70px; border-radius: 50%; object-fit: cover; border: 3px solid var(--c2); }
.info-text h4 { margin: 0; font-size: 17px; color: #333; }
.info-text p { margin: 3px 0; font-size: 13px; color: #777; }

.tenant-actions { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
.btn-sm { 
    border: none; padding: 8px; border-radius: 12px; font-size: 11px; font-weight: bold; 
    cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 4px; font-family: 'Sarabun', sans-serif;
}
.btn-view { background: var(--c2); color: #555; }
.btn-move { background: var(--c1); color: #555; }
.btn-del  { background: #ffebee; color: #c62828; }

.btn-add-global { 
    background: var(--c4); color: #856404; border: none; padding: 14px; 
    border-radius: 18px; font-weight: bold; cursor: pointer; width: 100%; margin-top: 10px; font-family: 'Sarabun', sans-serif;
}
.room-tag { background: var(--c5); color: white; padding: 4px 12px; border-radius: 10px; font-size: 12px; font-weight: bold; display: inline-block; margin-bottom: 5px;}
</style>
</head>
<body>

<div id="move-banner">
    <i class="fas fa-exchange-alt"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏¢‡πâ‡∏≤‡∏¢ ‡∏Ñ‡∏∏‡∏ì <span id="moving-name"></span> | ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á
    <button onclick="cancelMove()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
</div>

<div class="container">
    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÜ -->
    <div class="header-brand">
        <h1><i class="fas fa-users"></i> ‡∏ú‡∏±‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢</h1>
    </div>

    <div class="card">
        <div id="roomRowsContainer"></div>
    </div>
</div>

<!-- Modal -->
<div id="modal-overlay" onclick="closeModal(event)">
    <div class="modal-card" onclick="event.stopPropagation()">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <div id="modal-header"></div>
        <div class="tenant-list-area" id="modal-list-content"></div>
        <div id="modal-footer"></div>
    </div>
</div>

<script>
let roomData = [];
let movingJob = null;

// ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 50 ‡∏´‡πâ‡∏≠‡∏á
function init() {
    for(let f=1; f<=5; f++) {
        for(let r=1; r<=10; r++) {
            let id = f * 100 + r;
            let count = (id % 7 === 0) ? 0 : Math.floor(Math.random() * 2) + 1;
            let tenants = [];
            for(let i=0; i<count; i++) {
                tenants.push({
                    name: `‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤ ${i+1} ‡∏´‡πâ‡∏≠‡∏á ${id}`,
                    phone: `081-234-56${i}`,
                    date: "01/12/2025",
                    img: `https://i.pravatar.cc/150?u=${id}${i}`
                });
            }
            roomData.push({ id, floor: f, tenants });
        }
    }
    renderGrid();
}

function renderGrid() {
    const container = document.getElementById('roomRowsContainer');
    container.innerHTML = '';
    for(let f=1; f<=5; f++) {
        const row = document.createElement('div');
        row.className = 'floor-row';
        row.innerHTML = `<div class="floor-label">‡∏ä‡∏±‡πâ‡∏ô ${f}</div>`;
        const wrap = document.createElement('div');
        wrap.className = 'room-container';
        roomData.filter(r => r.floor === f).forEach(room => {
            const count = room.tenants.length;
            const isEmpty = count === 0;
            const card = document.createElement('div');
            card.className = `room-card ${isEmpty ? 'is-vacant-room' : 'has-tenant'}`;
            card.innerHTML = `
                <div style="font-size:20px">${isEmpty ? 'üë§' : (count > 1 ? 'üë•' : 'üë§')}</div>
                <b>${room.id}</b>
                <div class="count-tag">${isEmpty ? '‡∏ß‡πà‡∏≤‡∏á' : count + ' ‡∏Ñ‡∏ô'}</div>
            `;
            card.onclick = () => movingJob ? completeMove(room.id) : openRoomModal(room.id);
            wrap.appendChild(card);
        });
        row.appendChild(wrap);
        container.appendChild(row);
    }
}

function openRoomModal(id) {
    const room = roomData.find(r => r.id === id);
    const header = document.getElementById('modal-header');
    const list = document.getElementById('modal-list-content');
    const footer = document.getElementById('modal-footer');
    
    header.innerHTML = `<div class="room-tag">‡∏´‡πâ‡∏≠‡∏á ${room.id}</div><h2 style="margin:5px 0 15px; font-size: 20px;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢ (${room.tenants.length})</h2>`;
    
    let html = '';
    if (room.tenants.length > 0) {
        room.tenants.forEach((t, idx) => {
            html += `
                <div class="tenant-full-card">
                    <div class="tenant-main-info">
                        <img src="${t.img}" class="profile-img-big">
                        <div class="info-text">
                            <h4>${t.name}</h4>
                            <p>üìû ${t.phone}</p>
                            <p>üìÖ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å: ${t.date}</p>
                        </div>
                    </div>
                    <div class="tenant-actions">
                        <button class="btn-sm btn-view" onclick="alert('‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß')"><i class="fas fa-search"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                        <button class="btn-sm btn-move" onclick="startMove(${room.id}, ${idx})"><i class="fas fa-exchange-alt"></i> ‡∏¢‡πâ‡∏≤‡∏¢‡∏´‡πâ‡∏≠‡∏á</button>
                        <button class="btn-sm btn-del" onclick="deleteTenant(${room.id}, ${idx})"><i class="fas fa-trash"></i> ‡∏•‡∏ö‡∏≠‡∏≠‡∏Å</button>
                    </div>
                </div>`;
        });
    } else {
        html = '<div style="text-align:center; padding:40px; color:#ccc;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏Å‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ</div>';
    }
    
    list.innerHTML = html;
    footer.innerHTML = `<button class="btn-add-global" onclick="addTenant(${room.id})"><i class="fas fa-plus"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏•‡∏á‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ</button>`;
    
    document.getElementById('modal-overlay').style.display = 'flex';
}

function startMove(roomId, tenantIdx) {
    const room = roomData.find(r => r.id === roomId);
    movingJob = { fromRoom: roomId, idx: tenantIdx, data: room.tenants[tenantIdx] };
    
    document.getElementById('modal-overlay').style.display = 'none';
    document.getElementById('move-banner').style.display = 'block';
    document.getElementById('moving-name').innerText = movingJob.data.name;
    document.body.classList.add('moving-mode');
}

function completeMove(targetId) {
    const target = roomData.find(r => r.id === targetId);
    if (target.tenants.length >= 3) return alert('‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß');

    roomData.find(r => r.id === movingJob.fromRoom).tenants.splice(movingJob.idx, 1);
    target.tenants.push(movingJob.data);

    cancelMove();
    renderGrid();
    alert('‡∏¢‡πâ‡∏≤‡∏¢‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
}

function cancelMove() {
    movingJob = null;
    document.getElementById('move-banner').style.display = 'none';
    document.body.classList.remove('moving-mode');
}

function addTenant(id) {
    const name = prompt("‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤‡πÉ‡∏´‡∏°‡πà:");
    if(name) {
        roomData.find(r => r.id === id).tenants.push({
            name, phone: "08x-xxx-xxxx", date: "23/12/2025", img: `https://i.pravatar.cc/150?u=${Math.random()}`
        });
        renderGrid();
        openRoomModal(id);
    }
}

function deleteTenant(roomId, idx) {
    if(confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ?')) {
        roomData.find(r => r.id === roomId).tenants.splice(idx, 1);
        renderGrid();
        openRoomModal(roomId);
    }
}

function closeModal() { document.getElementById('modal-overlay').style.display = 'none'; }

init();
</script>
</body>
</html>