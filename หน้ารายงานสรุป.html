<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</title>
<!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏≠‡∏ô‡∏ï‡πå Sarabun ‡πÅ‡∏•‡∏∞ FontAwesome ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ -->
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
 --c1:#CCD5AE; --c2:#E9EDC9; --c3:#FEFAE0; --c4:#FAEDCD; --c5:#D4A373;
 --text: #555;
}
body{ 
    margin:0; 
    background:var(--c3); 
    font-family: 'Sarabun', sans-serif; 
    padding: 20px; 
    color: var(--text); 
}

.container { max-width: 1400px; margin: auto; }

/* --- Header: ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÜ --- */
.header-brand { text-align: center; margin-bottom: 30px; }
.header-brand h1 { color: var(--c5); margin: 0; font-size: 32px; font-weight: 600; }

/* --- UI ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å --- */
.card{ background:white; border-radius:24px; padding:30px; box-shadow:0 10px 30px rgba(0,0,0,.05); }

.report-header-inner { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    margin-bottom: 25px; 
    border-bottom: 2px solid var(--c2); 
    padding-bottom: 15px; 
    flex-wrap: wrap; 
    gap: 15px; 
}
.report-header-inner h3 { margin: 0; color: var(--c5); font-size: 20px; font-weight: 600; }

.filter-bar { display: flex; gap: 10px; margin-bottom: 25px; align-items: center; background: #f8faf5; padding: 12px; border-radius: 50px; padding-left: 25px; }
.filter-btn { padding: 8px 20px; border-radius: 30px; border: 1.5px solid var(--c5); background: white; cursor: pointer; font-size: 13px; font-weight: bold; color: var(--c5); transition: 0.3s; font-family: 'Sarabun', sans-serif; }
.filter-btn.active { background: var(--c5); color: white; }

.table-container { overflow-x: auto; border-radius: 20px; border: 1px solid #f0f0f0; }
.table { width: 100%; border-collapse: collapse; font-size: 14px; min-width: 1100px; }
.table th { background: var(--c2); color: var(--text); padding: 15px 10px; font-weight: 600; }
.table td { padding: 14px 10px; border-bottom: 1px solid #f5f5f5; text-align: center; }
.floor-group-header { background: #fafafa !important; text-align: left !important; font-weight: 800; padding-left: 25px !important; color: var(--c5); border-left: 5px solid var(--c5) !important; }

.btn-print { background: #217346; color: white; border: none; padding: 12px 28px; border-radius: 50px; cursor: pointer; font-weight: bold; display: flex; align-items: center; gap: 10px; transition: 0.3s; box-shadow: 0 4px 15px rgba(33, 115, 70, 0.2); font-family: 'Sarabun', sans-serif; }
.btn-print:hover { background: #1a5c38; transform: translateY(-2px); }
.btn-notify { background: var(--c1); color: #5d6d4e; border: none; padding: 8px 18px; border-radius: 20px; cursor: pointer; font-size: 12px; font-weight: bold; font-family: 'Sarabun', sans-serif; }

/* --- ‡∏£‡∏∞‡∏ö‡∏ö Preview --- */
#excel-preview-mode { 
    display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
    background: white; z-index: 10000; overflow-y: auto; padding: 40px; 
}
.preview-controls { display: flex; gap: 15px; margin-bottom: 30px; border-bottom: 1px solid #ddd; padding-bottom: 20px; }
.btn-back-rounded { background: #eee; color: #666; border: none; padding: 12px 25px; border-radius: 50px; cursor: pointer; font-weight: bold; font-family: 'Sarabun', sans-serif; }
.btn-confirm-rounded { background: #217346; color: white; border: none; padding: 12px 35px; border-radius: 50px; cursor: pointer; font-weight: bold; font-family: 'Sarabun', sans-serif; }

.excel-layout { width: 100%; border-collapse: collapse; border: 2.5px solid #000; font-size: 13px; margin-bottom: 20px; }
.excel-layout th, .excel-layout td { border: 1px solid #000; padding: 8px; text-align: center; color: black; }
.excel-layout th { background: #f2f2f2 !important; }

@media print {
    body > *:not(#excel-preview-mode) { display: none !important; }
    html, body { height: auto !important; margin: 0 !important; padding: 0 !important; background: white !important; }
    #excel-preview-mode { display: block !important; position: absolute !important; left: 0 !important; top: 0 !important; width: 100% !important; margin: 0 !important; padding: 0 !important; overflow: visible !important; }
    .print-page { display: block !important; width: 100% !important; page-break-after: always !important; padding: 1.5cm !important; box-sizing: border-box !important; }
    .preview-controls, .btn-notify { display: none !important; }
    @page { size: A4 landscape; margin: 0; }
}
</style>
</head>
<body>

<div class="container">
    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ -->
    <div class="header-brand">
        <h1><i class="fas fa-file-invoice-dollar"></i> ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h1>
    </div>

    <section id="reports">
        <div class="card">
            <div class="report-header-inner">
                <h3><i class="fas fa-chart-line"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô (‡∏£‡∏ß‡∏° 50 ‡∏´‡πâ‡∏≠‡∏á)</h3>
                <button onclick="showExcelPreview()" class="btn-print">
                    <i class="fas fa-file-pdf"></i> ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏¢‡∏Å‡∏ä‡∏±‡πâ‡∏ô (5 ‡∏´‡∏ô‡πâ‡∏≤ PDF)
                </button>
            </div>

            <div class="filter-bar">
                <span style="font-weight:bold; font-size:15px; color:var(--c5); margin-right:10px;">‡∏Å‡∏£‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠:</span>
                <button class="filter-btn active" onclick="filterReport('all', this)">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                <button class="filter-btn" onclick="filterReport(1, this)">‡∏ä‡∏±‡πâ‡∏ô 1</button>
                <button class="filter-btn" onclick="filterReport(2, this)">‡∏ä‡∏±‡πâ‡∏ô 2</button>
                <button class="filter-btn" onclick="filterReport(3, this)">‡∏ä‡∏±‡πâ‡∏ô 3</button>
                <button class="filter-btn" onclick="filterReport(4, this)">‡∏ä‡∏±‡πâ‡∏ô 4</button>
                <button class="filter-btn" onclick="filterReport(5, this)">‡∏ä‡∏±‡πâ‡∏ô 5</button>
            </div>

            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>‡∏´‡πâ‡∏≠‡∏á</th><th>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</th><th>‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤‡∏´‡∏•‡∏±‡∏Å</th><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞</th><th>‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á</th><th>‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤</th><th>‡∏ô‡πâ‡∏≥</th><th>‡πÑ‡∏ü</th><th>‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</th><th style="background:rgba(163, 177, 138, 0.2);">‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</th><th>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</th>
                        </tr>
                    </thead>
                    <tbody id="reportTableBody"></tbody>
                </table>
            </div>
        </div>
    </section>
</div>

<div id="excel-preview-mode">
    <div class="preview-controls">
        <button onclick="closeExcelPreview()" class="btn-back-rounded">‚¨ÖÔ∏è ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
        <button onclick="window.print()" class="btn-confirm-rounded">üñ®Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå 5 ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©</button>
    </div>
    <div id="print-area-content"></div>
</div>

<script>
const reportData = [];
const names = ["‡∏™‡∏°‡∏ä‡∏≤‡∏¢", "‡∏°‡∏¥‡∏ô‡∏ï‡∏£‡∏≤", "‡∏Å‡∏§‡∏©‡∏é‡∏≤", "‡∏ß‡∏¥‡∏†‡∏≤‡∏ß‡∏µ", "‡∏ò‡∏ô‡∏≤‡∏ß‡∏±‡∏™‡∏™‡πå", "‡∏≠‡∏≤‡∏£‡∏µ‡∏£‡∏±‡∏ï‡∏ô‡πå", "‡∏ô‡∏û‡∏î‡∏•", "‡∏û‡∏±‡∏ä‡∏£‡∏≤", "‡∏à‡∏¥‡∏£‡∏≤‡∏¢‡∏∏", "‡∏™‡∏¥‡∏£‡∏¥‡∏ô‡∏ò‡∏£"];

for (let f = 1; f <= 5; f++) {
    for (let r = 1; r <= 10; r++) {
        const roomId = f * 100 + r;
        const water = Math.floor(Math.random() * 100) + 120;
        const elec = Math.floor(Math.random() * 400) + 350;
        reportData.push({
            id: roomId, floor: f, recId: `REC6812-${roomId}`,
            name: `‡∏Ñ‡∏∏‡∏ì${names[r-1]} ‡πÉ‡∏à‡∏î‡∏µ`,
            date: `23/12/2568`,
            type: "‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô", rent: 4500, water: water, electric: elec, other: 300
        });
    }
}

function renderReport() {
    const tbody = document.getElementById('reportTableBody');
    tbody.innerHTML = '';
    let currentFloor = 0;
    reportData.forEach((item) => {
        if (item.floor !== currentFloor) {
            currentFloor = item.floor;
            tbody.innerHTML += `<tr data-floor="${currentFloor}"><td colspan="11" class="floor-group-header">üè¢ ‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà ${currentFloor}</td></tr>`;
        }
        const total = item.rent + item.water + item.electric + item.other;
        tbody.innerHTML += `
            <tr data-floor="${item.floor}">
                <td><b>${item.id}</b></td><td>${item.recId}</td><td>${item.name}</td><td>${item.date}</td>
                <td>${item.type}</td><td>${item.rent.toLocaleString()}</td><td>${item.water}</td><td>${item.electric}</td><td>${item.other}</td>
                <td style="font-weight:bold; color:#4F772D; background:rgba(163, 177, 138, 0.1);">${total.toLocaleString()}</td>
                <td><button class="btn-notify" onclick="alert('‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß')">üîî ‡πÅ‡∏à‡πâ‡∏á</button></td>
            </tr>`;
    });
}

function filterReport(f, btn) {
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    document.querySelectorAll('#reportTableBody tr').forEach(row => {
        const rowFloor = row.getAttribute('data-floor');
        row.style.display = (f === 'all' || rowFloor == f) ? '' : 'none';
    });
}

function showExcelPreview() {
    const printArea = document.getElementById('print-area-content');
    printArea.innerHTML = '';
    for(let f=1; f<=5; f++) {
        const floorRooms = reportData.filter(item => item.floor === f);
        const pageDiv = document.createElement('div');
        pageDiv.className = 'print-page';
        let totalF = 0;
        let html = `
            <div style="text-align:center; margin-bottom:20px; font-family: 'Sarabun', sans-serif;">
                <h2 style="margin:0;">Cozy Home Apartment - ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</h2>
                <h3 style="margin:5px 0;">‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà ${f} | ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏£‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏° ‡∏û.‡∏®. 2568</h3>
            </div>
            <table class="excel-layout" style="font-family: 'Sarabun', sans-serif;">
                <thead><tr><th>‡∏´‡πâ‡∏≠‡∏á</th><th>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</th><th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤</th><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤</th><th>‡∏ô‡πâ‡∏≥</th><th>‡πÑ‡∏ü</th><th>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</th><th>‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</th></tr></thead>
                <tbody>`;
        floorRooms.forEach(item => {
            const sum = item.rent + item.water + item.electric + item.other;
            totalF += sum;
            html += `<tr><td>${item.id}</td><td>${item.recId}</td><td>${item.name}</td><td>${item.date}</td><td>${item.rent}</td><td>${item.water}</td><td>${item.electric}</td><td>${item.other}</td><td style="font-weight:bold;">${sum.toLocaleString()}</td></tr>`;
        });
        html += `<tr style="font-weight:bold; background:#f2f2f2;"><td colspan="8" style="text-align:right;">‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà ${f}</td><td>${totalF.toLocaleString()}</td></tr></tbody></table>
            <div style="display:flex; justify-content:space-between; margin-top:30px; font-weight:bold; font-family: 'Sarabun', sans-serif;">
                <p>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: ................................</p>
                <p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏¥‡∏°‡∏û‡πå: ${new Date().toLocaleDateString('th-TH')}</p>
            </div>`;
        pageDiv.innerHTML = html;
        printArea.appendChild(pageDiv);
    }
    document.getElementById('excel-preview-mode').style.display = 'block';
}

function closeExcelPreview() { document.getElementById('excel-preview-mode').style.display = 'none'; }

renderReport();
</script>
</body>
</html>